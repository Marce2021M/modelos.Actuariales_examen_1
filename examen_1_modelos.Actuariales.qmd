---
title: "Modelos Actuariales"
subtitle: "Actuarial 3"
lang: es
author: "Marcelino Sánchez"
date: today
format:
  html:
    page-layout: full
    embed-resources: true
editor_options: 
  chunk_output_type: console
---


```{r, echo=FALSE, results=FALSE, warning=FALSE, message=FALSE}
# Cargamos la libreria
library(readxl)
library(ggplot2)
library(dplyr)
library(tidyverse)

# Supuestos principales
# 191654
# edad del asegurado
xEdad <- 16+30
#vigencia del seguro
n <- 19
#tasa de interes efectiva anual
itasaBase <- .05
#numero de primas anuales
mPrimas <- 4
# Sumas aseguradas
saMuerte <- 2000000
saSupervivencia <- 1000000

# Leeremos la tabla de mortalidad

# Leemos la tabla de mortalidad
tablaMortalidad <- read_excel("Tabla_mortalidad.xlsx")

qTablaMortalidad <- data.frame(px = numeric(length(tablaMortalidad$lx)-xEdad), kSuperv = numeric(length(tablaMortalidad$lx)-xEdad))


# Creamos la columna de supervivencia

for(i in (xEdad+1):length(tablaMortalidad$lx)){
  qTablaMortalidad$px[i-xEdad] <- tablaMortalidad$lx[i]/tablaMortalidad$lx[xEdad+1] 
  qTablaMortalidad$kSuperv[i-xEdad] <- i-xEdad
}

# Hacemos función de gastos extras

gastosExtrasPrimas <- function(anio){
  if(anio == 0){
    return(1000 + primaEmision*.4)
  }else if(anio %in% c(1,2)){
    return(500+.2*primaEmision)
  }else {
    return(100 + .05*primaEmision)
  }
}

gastosExtrasLiquidacion <- function(salida){
  if(salida == "muerte"){
    return(3000 + saMuerte*.003)
  }else{
    return(1000+saSupervivencia*.001)
}}

# Hacemos función de valores garantizados

valoresGarantizados <- function(valorPoliza, anio){
  if(anio %in% c(1,2)){
    return(valorPoliza*.8)
  }else{
    return(valorPoliza*.9)
  }
}

nCarteraAsegurados <- 100

# Extraemos datos de la hoja de excel valores observados




```

# Nota Técnica

## 1. Descripción de la cobertura del seguro

### a. Tipo de seguro

Es un seguro dotal mixto.

### b. Temporalidad

El seguro tiene una vigencia de `r n` años con primas niveladas por 4 años anticipadamente.

### c. Población asegurada

La edad de los asegurados es de `r xEdad` años.

## 2. Hipótesis demográficas y financieras

### a. Hipótesis demográfica

Utilizaremos la tabla proporcionada por la aseguradora. La cual para una persona de `r xEdad` años se ve de la siguiente manera:

```{r,  echo=FALSE}
              
# Graficamos la tabla

ggplot(qTablaMortalidad, aes(x = kSuperv, y = px)) +
  geom_line() +
  geom_point() +
  labs(title = "Tabla de mortalidad", x = "Supervivencia", y = "px") 
```

### b. Hipótesis sobre costos



### c. Hipótesis sobre tasa de interés

## 3. Procedimientos técnicos

### a. Prima neta

(Fórmula para el cálculo y valor obtenido)

### b. Prima recargada

(Fórmula para el cálculo y valor obtenido)

### c. Valores póliza asociados a la prima neta

(Fórmula para el cálculo y valores obtenidos para toda la vigencia de la póliza)

### d. Valores póliza asociados a la prima recargada

(Fórmula para el cálculo y valores obtenidos para toda la vigencia de la póliza)

### e. Valores garantizados

(Fórmula para el cálculo y valores obtenidos mientras haya pago de primas)

# Profit testing

## 1. Análisis determinista

### a. Hipótesis demográ ficas y financieras

(Elige las variables a analizar, mínimo 2, y los supuestos realistas que vas a utilizar)

### b. Valor Presente Neto (VPN)

(Fórmula para el cálculo y valor obtenido)

### c. Margen de Utilidad (MU)

(Fórmula para el cálculo y valor obtenido)

## 2. Análisis estocástico

### a. Análisis stress-testing para el VPN y MU

(Escoge 2 variables y realiza el stress testing)

### b. Análisis por escenarios para el VPN y MU

(Plantea 5 escenarios para realizar el análisis)

### c. Análisis por simulación

#### c.1. Hipótesis para la simulación de las variables a analizar

#### c.2. Histograma de 1000 realizaciones de VPN y MU

#### c.3. Promedio y desviación estándar de las 1000 realizaciones de VPN y MU

# Para una cartera de 100 asegurados: Fondo Total

## 1. Asset-share

(Fórmula para el cálculo y valores obtenidos para toda la vigencia de la póliza)

## 2. Estimación del Fondo Total mediante el Asset-share

(Fórmula para el cálculo y valores obtenidos para toda la vigencia de la póliza)

# Análisis de Rentabilidad

## 1. Utilidades

(Fórmula para el cálculo y valores obtenidos para toda la vigencia de la póliza)

## 2. VPN

(Fórmula para el cálculo y valor obtenido)

## 3. MU

(Fórmula para el cálculo y valor obtenido)
